<div class="matched-user-page" *ngIf="userProfileValue | async; let userProfile">
    <div class="matched-user-page__header">
        <div class="matched-user-page__header__actions">
            <a routerLink="/matches" class="matched-user-page__header__back interactable"><i class="fas fa-chevron-left"></i></a>
        </div>
        <div class="matched-user-page__header__title">
            <div class="matched-user-page__header__title__avatar" [style.background-image]="'url(' + userProfile.pictures?.[0] + ')'"></div>
            <span class="matched-user-page__header__title__content">{{userProfile.name}}</span>
        </div>
        <div class="matched-user-page__header__actions"></div>
    </div>

    <div class="matched-user-page__content">
        <div class="matched-user-page__content__messages">
            <div class="matched-user-page__content__messages__system-message">Pour garantir votre s√©curit√©, veillez √† ne pas partager d'informations personnelles ou confidentielles dans les messages, car ceux-ci ne sont pas encrypt√©s. Restons prudents et respectons la confidentialit√©.</div>

            <app-card class="matched-user-page__content__messages__question" *ngIf="((messages | async)?.length ?? 0) == 0">
                <span class="matched-user-page__content__messages__question__description">Voici un id√©e de question pour d√©buter la conversation :</span>
                <div class="matched-user-page__content__messages__question__question">{{question}}</div>
                <div class="matched-user-page__content__messages__question__actions">
                    <a class="matched-user-page__content__messages__question__actions__action interactable" (click)="updateQuestion()"><i class="fas fa-sync"></i> Nouvelle question</a>
                    <a class="matched-user-page__content__messages__question__actions__action interactable" (click)="sendMessage(question)"><i class="fas fa-paper-plane"></i> Envoyer</a>
                </div>
            </app-card>

            <div class="matched-user-page__content__messages__group" [ngClass]="{'matched-user-page__content__messages__group--self': messageGroup.isSelf, 'matched-user-page__content__messages__group--other': !messageGroup.isSelf}" *ngFor="let messageGroup of messages | async">
                <span class="matched-user-page__content__messages__group__time">{{messageGroup.date | date: 'MMM d, h:mm'}}</span>
                <div class="matched-user-page__content__messages__group__content">
                    <div class="matched-user-page__content__messages__group__content__sender" *ngIf="!messageGroup.isSelf">
                        <div class="matched-user-page__content__messages__group__content__sender__avatar"></div>
                    </div>
                    <div class="matched-user-page__content__messages__group__content__messages">
                        <div class="matched-user-page__content__messages__group__content__messages__message" *ngFor="let message of messageGroup.messages">
                            {{message.content}}
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
    
    <form class="matched-user-page__footer" (submit)="onSubmit()" [formGroup]="form">
        <input class="matched-user-page__footer__control" placeholder="Aa" type="text" formControlName="message">
        <button class="matched-user-page__footer__button interactable" type="submit" *ngIf="(form.value.message?.length ?? 0) > 0"><i class="fas fa-paper-plane"></i></button>
        <a class="matched-user-page__footer__button interactable" (click)="sendMessage('üëç')" *ngIf="(form.value.message?.length ?? 0) === 0"><span class="emoji">üëç</span></a>
    </form>
</div>